
{
  "entities": {
    "User": {
      "title": "User",
      "type": "object",
      "description": "Represents a user within the SyllabiQ platform.",
      "properties": {
        "uid": {
          "type": "string",
          "description": "Unique identifier for the User entity."
        },
        "email": {
          "type": "string",
          "description": "Email address of the user.",
          "format": "email"
        },
        "name": {
          "type": "string",
          "description": "Display name of the user."
        },
        "role": {
          "type": "string",
          "description": "Role of the user, one of 'student', 'teacher', or 'admin'.",
          "enum": ["student", "teacher", "admin"]
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp indicating when the user was created."
        },
        "lastLogin": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp indicating the user's last login."
        },
        "isActive": {
          "type": "boolean",
          "description": "Indicates if the user account is active."
        }
      },
      "required": ["uid", "email", "role", "name", "createdAt", "isActive"]
    },
    "Meeting": {
      "title": "Meeting",
      "type": "object",
      "description": "Represents a meeting session within the SyllabiQ platform.",
      "properties": {
        "meetingCode": {
          "type": "string",
          "description": "Unique human-readable code for the meeting."
        },
        "meetingRoomId": {
          "type": "string",
          "description": "Unique identifier for the meeting room (UUID)."
        },
        "hostUid": {
          "type": "string",
          "description": "Reference to the User who is hosting the meeting."
        },
        "isActive": {
          "type": "boolean",
          "description": "Indicates whether the meeting is currently active."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the meeting was created.",
          "format": "date-time"
        }
      },
      "required": [
        "meetingCode",
        "meetingRoomId",
        "hostUid",
        "isActive",
        "createdAt"
      ]
    },
    "Participant": {
      "title": "Participant",
      "type": "object",
      "description": "Represents a participant in a meeting.",
      "properties": {
        "uid": {
          "type": "string",
          "description": "Reference to the User participating in the meeting."
        },
        "name": {
          "type": "string",
          "description": "Display name of the participant."
        },
        "role": {
          "type": "string",
          "description": "Role of the participant (teacher or student)."
        },
        "joinedAt": {
          "type": "string",
          "description": "Timestamp indicating when the participant joined.",
          "format": "date-time"
        },
        "cameraOn": {
          "type": "boolean",
          "description": "Indicates if the camera is on."
        },
        "micOn": {
          "type": "boolean",
          "description": "Indicates if the mic is on."
        }
      },
      "required": ["uid", "role", "name", "joinedAt", "cameraOn", "micOn"]
    },
     "Ticket": {
      "title": "Ticket",
      "type": "object",
      "description": "Represents a paid ticket for a one-on-one session.",
      "properties": {
        "ticketCode": { "type": "string", "description": "Unique human-readable code for the ticket." },
        "orderId": { "type": "string", "description": "Idempotent unique identifier for the transaction (e.g., from a payment gateway)." },
        "studentId": { "type": "string", "description": "UID of the student who bought the ticket." },
        "teacherId": { "type": "string", "description": "UID of the teacher for whom the ticket is valid." },
        "status": { 
          "type": "string", 
          "enum": ["PAID", "WAITING_FOR_TEACHER", "ACTIVE", "COMPLETED", "CANCELLED", "REFUND_PROCESSED"],
          "description": "The current state of the ticket lifecycle."
        },
        "price": { "type": "number", "description": "The cost of the ticket." },
        "duration": { "type": "number", "description": "Session duration in minutes." },
        "commissionPercent": { "type": "number", "description": "Platform commission percentage." },
        "createdAt": { "type": "string", "format": "date-time", "description": "Timestamp of ticket creation." },
        "validFrom": { "type": "string", "format": "date-time", "description": "The timestamp from which the ticket is valid (session start - 15m)." },
        "validTill": { "type": "string", "format": "date-time", "description": "The timestamp until which the ticket is valid (session end + 30m)." },
        "used": { "type": "boolean", "description": "Indicates if the ticket has been consumed to join a meeting." },
        "checkInTime": { "type": "string", "format": "date-time", "description": "Timestamp when the student checked into the meeting." },
        "activatedAt": { "type": "string", "format": "date-time", "description": "Timestamp when the session became active." },
        "endedAt": { "type": "string", "format": "date-time", "description": "Timestamp when the session ended." },
        "refundEligible": { "type": "boolean", "description": "Indicates if the ticket is eligible for a refund." }
      },
      "required": ["ticketCode", "orderId", "studentId", "teacherId", "status", "price", "duration", "createdAt", "validFrom", "validTill", "used"]
    },
    "WhiteboardStroke": {
      "title": "Whiteboard Stroke",
      "description": "A single drawing action on a whiteboard.",
      "type": "object",
      "properties": {
        "points": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "x": { "type": "number" },
              "y": { "type": "number" }
            },
            "required": ["x", "y"]
          }
        },
        "tool": { "type": "string", "enum": ["pen", "eraser", "shape", "text"] },
        "shape": { "type": "string", "enum": ["rectangle", "circle", "line", "arrow", null] },
        "color": { "type": "string" },
        "size": { "type": "number" },
        "timestamp": { "type": "string", "format": "date-time" }
      },
      "required": ["points", "tool", "color", "size", "timestamp"]
    }
  },
  "auth": {
    "providers": ["password"]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{uid}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profile information, including their role.",
          "params": [
            {
              "name": "uid",
              "description": "The unique identifier of the user."
            }
          ]
        }
      },
      {
        "path": "/meetings/{meetingCode}",
        "definition": {
          "entityName": "Meeting",
          "schema": {
            "$ref": "#/backend/entities/Meeting"
          },
          "description": "Stores meeting metadata, linking a human-readable code to a unique room ID.",
          "params": [
            {
              "name": "meetingCode",
              "description": "The unique, human-readable meeting code."
            }
          ]
        }
      },
      {
        "path": "/participants/{meetingRoomId}/users/{uid}",
        "definition": {
          "entityName": "Participant",
          "schema": {
            "$ref": "#/backend/entities/Participant"
          },
          "description": "Acts as a real-time presence list for each meeting room.",
          "params": [
            {
              "name": "meetingRoomId",
              "description": "The unique identifier for the meeting room (UUID)."
            },
            {
              "name": "uid",
              "description": "The unique identifier of the user participating."
            }
          ]
        }
      },
      {
        "path": "/tickets/{ticketId}",
        "definition": {
          "entityName": "Ticket",
          "schema": {
            "$ref": "#/backend/entities/Ticket"
          },
          "description": "Stores information about a paid session ticket.",
          "params": [
            {
              "name": "ticketId",
              "description": "The unique identifier of the ticket document."
            }
          ]
        }
      },
      {
        "path": "/whiteboards/{meetingId}/strokes/{strokeId}",
        "definition": {
          "entityName": "WhiteboardStroke",
          "schema": {
            "$ref": "#/backend/entities/WhiteboardStroke"
          },
          "description": "Stores individual drawing strokes for a meeting's whiteboard.",
          "params": [
            {
              "name": "meetingId",
              "description": "The unique identifier of the meeting."
            },
            {
              "name": "strokeId",
              "description": "The unique identifier of the whiteboard stroke."
            }
          ]
        }
      }
    ]
  }
}
